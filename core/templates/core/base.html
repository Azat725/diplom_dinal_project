<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LMS System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ */
        :root {
            --primary-red: #B03A2E;
            --primary-red-hover: #922B21;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –°–í–ï–¢–õ–û–ô —Ç–µ–º—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) */
        [data-bs-theme="light"] {
            --bg-body: #f8f9fa;
            --bg-card: #ffffff;
            --text-main: #212529;
            --text-muted: #6c757d;
            --border-color: #dee2e6;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –¢–ï–ú–ù–û–ô —Ç–µ–º—ã */
        [data-bs-theme="dark"] {
            --bg-body: #121212; /* –ü–æ—á—Ç–∏ —á–µ—Ä–Ω—ã–π */
            --bg-card: #1e1e1e; /* –¢–µ–º–Ω–æ-—Å–µ—Ä—ã–π –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ */
            --text-main: #e0e0e0; /* –°–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π —Ç–µ–∫—Å—Ç */
            --text-muted: #a0a0a0;
            --border-color: #333333;
        }

        /* –ü—Ä–∏–º–µ–Ω—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ */
        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            transition: background-color 0.3s, color 0.3s;
        }

        .card {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            color: var(--text-main);
        }
        
        /* –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–ª—è –≤–≤–æ–¥–∞ –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
        [data-bs-theme="dark"] input, 
        [data-bs-theme="dark"] select, 
        [data-bs-theme="dark"] textarea {
            background-color: #2c2c2c;
            border-color: #444;
            color: #fff;
        }
        
        [data-bs-theme="dark"] .table {
            color: var(--text-main);
            border-color: var(--border-color);
        }

        /* –ö—Ä–∞—Å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –∫—Ä–∞—Å–Ω—ã–º–∏ –≤–µ–∑–¥–µ */
        .btn-custom {
            background-color: var(--primary-red);
            color: white;
            border: none;
        }
        .btn-custom:hover {
            background-color: var(--primary-red-hover);
            color: white;
        }
        
        .navbar-brand {
            color: var(--primary-red) !important;
            border-left: 3px solid var(--primary-red);
            padding-left: 10px;
        }
    </style>
</head>
<body class="d-flex flex-column min-vh-100">

    {% if user.is_authenticated %}
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm mb-4">
        <div class="container">
            <a class="navbar-brand" href="{% url 'index' %}">–£—á–µ–±–Ω—ã–π –ü–æ—Ä—Ç–∞–ª</a>
            
            <div class="d-flex align-items-center">
                <span class="me-3 text-secondary d-none d-md-block">
                    {{ user.get_full_name|default:user.username }}
                    {% if user.is_teacher %} <span class="badge bg-secondary">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å</span> {% endif %}
                    {% if user.is_student %} <span class="badge bg-info text-dark">–°—Ç—É–¥–µ–Ω—Ç</span> {% endif %}
                </span>

                {% if user.is_teacher %}
                    <a href="{% url 'teacher_dashboard' %}" class="btn btn-outline-warning btn-sm me-2">–ü–∞–Ω–µ–ª—å —É—á–∏—Ç–µ–ª—è</a>
                {% endif %}
                
                <a href="{% url 'student_results' %}" class="btn btn-outline-danger btn-sm me-2">–ú–æ–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</a>
                <button class="btn btn-outline-secondary btn-sm me-2" id="theme-toggle" title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É">
                    üåó
                </button>
                <a href="{% url 'logout' %}" class="btn btn-outline-dark btn-sm">–í—ã–π—Ç–∏</a>
            </div>
        </div>
    </nav>
    {% endif %}

    <div class="container flex-grow-1">
        {% block content %}
        {% endblock %}
    </div>

    <script>
        // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∫–∞–∫–∞—è —Ç–µ–º–∞ –±—ã–ª–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Ä–∞–Ω–µ–µ
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-bs-theme', savedTheme);

        // 2. –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
        const themeToggleBtn = document.getElementById('theme-toggle');
        
        if (themeToggleBtn) {
            themeToggleBtn.addEventListener('click', () => {
                // –£–∑–Ω–∞–µ–º —Ç–µ–∫—É—â—É—é —Ç–µ–º—É
                const currentTheme = document.documentElement.getAttribute('data-bs-theme');
                // –ú–µ–Ω—è–µ–º –Ω–∞ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—É—é
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';

                // –ü—Ä–∏–º–µ–Ω—è–µ–º –∞—Ç—Ä–∏–±—É—Ç –∫ HTML (–¥–ª—è Bootstrap)
                document.documentElement.setAttribute('data-bs-theme', newTheme);

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä –≤ –±—Ä–∞—É–∑–µ—Ä–µ
                localStorage.setItem('theme', newTheme);
            });
        }
        </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>